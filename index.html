<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Credit Application - Inti Water</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            padding: 10px;
            background: #f5f5f5;
        }

        .form-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border: 8px solid #035ab1f1;
            padding: 20px;
            border-radius: 5px;
        }

        .header-table {
            width: 100%;
            margin-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 20px;
            border-radius: 10px;
        }

        .logo {
            width: 80px;
            height: 80px;
            border: 3px solid #0099cc;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
        }

        .droplet {
            width: 40px;
            height: 50px;
            background: #0099cc;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            position: relative;
        }

        .droplet::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 25px;
            background: white;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
        }

        .company-name {
            font-size: 24px;
            font-weight: bold;
            letter-spacing: 3px;
        }

        .company-name span {
            color: #0099cc;
        }

        .tagline {
            font-size: 11px;
            color: #666;
            letter-spacing: 1px;
        }

        .contact-info {
            font-size: 11px;
            color: #333;
            margin-top: 5px;
        }

        .form-title {
            font-size: 30px;
            font-weight: bold;
            color: #000;
            text-align: center;
            margin-bottom: 10px;
        }

        .date-amount-inputs {
            text-align: center;
        }

        .date-amount-inputs input {
            border: 2px solid #333;
            padding: 5px 10px;
            font-size: 11px;
            margin: 0 5px;
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-top: 24px;
            border: 1px solid #000;
            border-radius: 15px; 
            overflow: hidden;
        }

        .section-header {
            background: linear-gradient(to left, blue,rgb(49, 90, 155));
            color: white;
            padding: 5px;
            font-weight: bold;
            font-size: 14px;
            text-align: center;
        }

        td {
            border: 1px solid #000;
            border-width: 1px;
            padding: 1px;
            vertical-align: top;
        }

        .field-label {
            display: block;
            font-size: 13px;
            color: #333;
            font-weight: 600;
            margin-bottom: 2px;
            padding: 2px;
        }

        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="date"],
        input[type="file"] {
            width: 100%;
            height: 24px;
            border: none;
            outline: none;
            padding: 2px;
            font-size: 12px;
            border-radius: 4px;
        }

        .checkbox-section {
            display: flex;
            gap: 17px;
            font-size: larger;
            padding-left: 20px;
            align-items: center;
        }

        .checkbox-section label {
            font-size: 10px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .disclaimer {
            font-size: 8px;
            padding: 10px;
            background: #f9f9f9;
            border: 1px solid #0099cc;
            margin-top: 10px;
            line-height: 1.4;
        }

        .agreement-section {
            background: #0099cc;
            color: white;
            padding: 8px;
            font-size: 7px;
            line-height: 1.5;
            margin-top: 10px;
        }

        .signature-cell {
            height: 100%;
            position: relative;
        }

        .signature-label {
            position: absolute;
            bottom: 5px;
            left: 8px;
            font-size: 9px;
            font-weight: 600;
            color: #333;
        }
        canvas {
            border-radius: 8px;
            background: #fff;
            display: block;
        }
        #footer{
            display: flex;
            justify-content: space-around;
            align-items: center;
        }
        .form-container1{
            display: none;
        }

        @media print {
            body {
                padding: 0;
                background: white;
            }
            .form-container {
                border-width: 4px;
            }
        }
    @media (max-width: 1024px) {
      .form-container {
        border-width: 6px;
      }
      .form-title {
        font-size: 24px;
      }
      input[type="text"] {
        font-size: 11px;
      }

    }

    @media (max-width: 768px) {
      .form-container {
        padding: 15px;
      }

      table {
        display: block;
        overflow-x: auto;
      }

      .form-title {
        font-size: 22px;
      }

      td {
        font-size: 11px;
      }

      #savePdf {
        width: 100%;
      }
    }

     @media (max-width: 480px) {
     * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            padding: 10px;
            background: #f5f5f5;
        }
        .form-container{
            display: none;

        }
        .form-container1 {
           display: block;
            max-width: 100%;
            margin: 0 auto;
            background: white;
            border: 5px solid #035ab1f1;
            padding: 15px;
            border-radius: 5px;
            overflow-y: auto;  
            overscroll-behavior: auto;  
            touch-action: pan-y;   
        }

        /* Header Section */
        .header-section {
            text-align: center;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
            margin-bottom: 20px;
        }
        .company-name {
            font-size: 20px;
            font-weight: bold;
            letter-spacing: 2px;
            margin-bottom: 5px;
        }

        .form-title {
            font-size: 22px;
            font-weight: bold;
            color: #000;
            margin: 15px 0;
        }

        /* Section Header */
        .section-header {
            background: linear-gradient(to left, blue, rgb(49, 90, 155));
            color: white;
            padding: 10px;
            font-weight: bold;
            font-size: 13px;
            text-align: center;
            margin-top: 20px;
            margin-bottom: 15px;
            border-radius: 5px;
            border: 1px solid #000;
        }

        /* Field Groups */
        .field-group {
            margin-bottom: 15px;
            width: 100%;
        }

        .field-label {
            display: block;
            font-size: 12px;
            color: #333;
            font-weight: 600;
            margin-bottom: 5px;
        }

        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="date"],
        input[type="file"] {
            width: 100%;
            border: 1px solid #ccc;
            outline: none;
            font-size: 13px;
            padding: 8px;
            border-radius: 4px;
            background: white;
        }

        /* Checkbox Section */
        .checkbox-section {
            display: flex;
            gap: 10px;
            padding: 10px;
            background: #f9f9f9;
            border-radius: 5px;
        }

        .checkbox-section label {
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-section input[type="checkbox"] {
            width: 18px;
            height: 18px;
        }

        /* Disclaimer */
        .disclaimer {
            font-size: 10px;
            padding: 10px;
            background: #f9f9f9;
            border: 1px solid #0099cc;
            margin-top: 15px;
            line-height: 1.5;
            border-radius: 5px;
        }

        /* Consent Text */
        .consent-text {
            font-size: 9px;
            padding: 10px;
            background: linear-gradient(to right, rgba(0, 0, 255, 0.833), lightblue);
            color: white;
            line-height: 1.5;
            margin-top: 20px;
            border-radius: 5px;
        }

        /* Signature Section */
        .signature-box {
            margin-top: 20px;
            margin-bottom: 15px;
        }

        .signature-box h4 {
            font-size: 12px;
            margin-bottom: 10px;
            color: #333;
        }

        canvas {
            border: 1px solid #ccc;
            border-radius: 8px;
            background: #fff;
            width: 100%;
            height: 120px;
            display: block;
            -ms-touch-action: none !important;
            user-select: none;
            position: relative;
            z-index: 9999;
            touch-action: none;
            
        }

        .signature-date {
            margin-top: 10px;
        }

        /* Footer */
        .footer {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid #e0e0e0;
        }

        .footer label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 13px;
        }

        #savePdf1 {
            width: 100%;
            background: #0099cc;
            color: white;
            padding: 14px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin-top: 15px;
        }

        #savePdf1:hover {
            background: #007aa3;
        }

        #fileError {
            color: red;
            font-size: 12px;
            margin-top: 5px;
        }

        /* Divider */
        .divider {
            height: 1px;
            background: #e0e0e0;
            margin: 20px 0;
        }
    } 
    </style>
</head>
<body>
    <div class="form-container">
        <table class="header-table" style="position: relative; border: none; margin-bottom: 10px; border-radius: 10px; " >
            <tr>
                <td style="border: none; width: 30%; padding: 15px; ">
                    <img src="images//MainLogo.PNG" alt="" id="mainLogo">
                </td>
                <td style="border: none; width: fit; height: 60%; margin-top: 90px; text-align: center; display: flex; justify-content: center; align-items: center; flex-direction: column;">
                    <div class="form-title">Credit Application / Aplicación de Crédito</div>
                </td>
                <td style="border: none; width: 30%; text-align: right; ">
                   <div style="display: flex; justify-content: end; line-height: 10px; height:100px; margin-top: 60px; margin-bottom: 40px;">
                        <img src="images/logo.png"  alt="" width="300px" height="150px" id="logo">
                   </div>
                   <div style="width: 450px; position: absolute; right:10px;" >
                    <table>
                        <tr >
                            <td colspan="2" style="text-align: start; height: 10px;" >
                                <span class="field-label">Date /Fecha <span style="color: red;">*</span></span>
                                <input type="date" style="width: 100%; padding: 2px;" name="Date/Fecha1" class="Date/Fecha1" required >
                            </td>
                            <td colspan="2" style="text-align: start;" >
                                <span class="field-label">Amount to Finance / Monto a Financiar <span style="color: red;">*</span></span>
                                <input type="text" style="width: 100%;" name="AmounttoFinance/MontoaFinanciar1" class="AmounttoFinance/MontoaFinanciar1" required>
                            </td>
                        </tr>
                    </table>

                </div>
            </td>
        </tr>
        <table>
            <tr>
                <td colspan="4" class="section-header">Applicant / Aplicante</td>
                <td colspan="4" class="section-header">Co-Applicant / Co-Aplicante</td>
            </tr>
            <tr>
                <td colspan="2">
                    <span class="field-label">First Name / Nombre <span style="color: red;">*</span></span>
                    <input type="text" style="width: 100%; padding: 2px;" name="FirstName/Nombre1" class="FirstName/Nombre1" required>
                </td>
                <td colspan="2">
                    <span class="field-label">Last Name / Apellido <span style="color: red;">*</span></span>
                    <input type="text" name="LastName/Apellido1" class="LastName/Apellido1" required>
                </td>
                <td colspan="2">
                    <span class="field-label">First Name / Nombre </span>
                    <input type="text" name="First Name/Nombre2" class="First Name/Nombre2">
                </td>
                <td colspan="2" >
                    <span class="field-label">Last Name / Apellido </span>
                    <input type="text" name="Last Name/Apellido2" class="Last Name/Apellido2">
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <span class="field-label">Social Security # / Nro. Seguro Social<span style="color: red;">*</span></span>
                    <input type="text" name="SocialSecurity#/Nro.SeguroSocial1" class="SocialSecurity#/Nro.SeguroSocial1" required>
                </td>
                <td colspan="2">
                    <span class="field-label">Date of Birth / Fecha de Nacimiento <span style="color: red;">*</span></span>
                    <input type="date" name="DateofBirth/FechadeNacimiento1" class="DateofBirth/FechadeNacimiento1" required>
                </td>
                <td colspan="2">
                    <span class="field-label">Social Security # / Nro. Seguro Social</span>
                    <input type="text" name="SocialSecurity#/Nro.SeguroSocial2" class="SocialSecurity#/Nro.SeguroSocial2">
                </td>
                <td colspan="2">
                    <span class="field-label">Date of Birth / Fecha de Nacimiento</span>
                    <input type="date" name="DateofBirth/FechadeNacimiento2" class="DateofBirth/FechadeNacimiento2">
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <span class="field-label"> Driver’s License # / ID # <span style="color: red;">*</span></span>
                    <input type="text" name="Driver’sLicense#/ID#1" class="Driver’sLicense#/ID#1" required>
                </td>
                <td colspan="2">
                    <span class="field-label">Expiration Date / Fecha de Expiración <span style="color: red;">*</span></span>
                    <input type="date" name="ExpirationDate/FechadeExpiración1" class="ExpirationDate/FechadeExpiración1" required>
                </td>
                <td colspan="2">
                    <span class="field-label"> Driver’s License # / ID #</span>
                    <input type="text" name="Driver’sLicense#/ID#2" class="Driver’sLicense#/ID#2">
                </td>
                <td colspan="2">
                    <span class="field-label">Expiration Date / Fecha de Expiración</span>
                    <input type="date" name="ExpirationDate/FechadeExpiración2" class="ExpirationDate/FechadeExpiración2">
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <span class="field-label">Phone / Teléfono <span style="color: red;">*</span></span>
                    <input type="tel" name="Phone/Teléfono1" class="Phone/Teléfono1" required>
                </td>
                <td colspan="2">
                    <span class="field-label">Email <span style="color: red;">*</span></span>
                    <input type="email" name="Email1" class="Email1" required>
                </td>
                <td colspan="2">
                    <span class="field-label">Phone / Teléfono</span>
                    <input type="tel" name="Phone/Teléfono2" class="Phone/Teléfono2">
                </td>
                <td colspan="2">
                    <span class="field-label">Email</span>
                    <input type="email" name="Email2" class="Email2">
                </td>
            </tr>
            <tr>
                <td colspan="4">
                    <span class="field-label">Address / Dirección <span style="color: red;">*</span></span>
                    <input type="text" name="Address/Dirección1" class="Address/Dirección1" required>
                </td>
                <td colspan="4">
                    <span class="field-label">Address / Dirección</span>
                    <input type="text" name="Address/Dirección2" class="Address/Dirección2">
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <span class="field-label"> City / Ciudad <span style="color: red;">*</span></span>
                    <input type="text" name="City/Ciudad1" class="City/Ciudad1" required>
                </td>
                <td>
                    <span class="field-label">State / Estado <span style="color: red;">*</span></span>
                    <input type="text" name="State/Estado1" class="State/Estado1" required>
                </td>
                <td>
                    <span class="field-label">Zip Code / Código Postal <span style="color: red;">*</span></span>
                    <input type="text" name="ZipCode/CódigoPostal1" class="ZipCode/CódigoPostal1" required>
                </td>
                <td colspan="2">
                    <span class="field-label"> City / Ciudad</span>
                    <input type="text" name="City/Ciudad2" class="City/Ciudad2">
                </td>
                <td>
                    <span class="field-label">State / Estado</span>
                    <input type="text" name="State/Estado2" class="State/Estado2">
                </td>
                <td>
                    <span class="field-label">Zip Code / Código Postal</span>
                    <input type="text" name="ZipCode/CódigoPostal2" class="ZipCode/CódigoPostal2">
                </td>
            </tr>
        </table>

        <table>
            <tr>
                <td colspan="8" class="section-header">Mortgage Information / Información Hipotecaria</td>
            </tr>
            <tr>
                <td colspan="2">
                    <span class="field-label">Status / Estado <span style="color: red;">*</span></span>
                    <div class="checkbox-section" >
                        <label><input type="checkbox" name="Paid/Pagada" class="Paid/Pagada">Paid / <br>Pagada</label>
                        <label><input type="checkbox" name="Mortgaged/Financiada" id="Mortgaged/Financiada">Mortgaged / <br>Financiada</label>
                        <label><input type="checkbox" name="Rent/Alquiler" class="Rent/Alquiler">Rent / <br>Alquiler</label>
                    </div>
                </td>
                <td colspan="2">
                    <span class="field-label">Mortgage Company / Financiera</span>
                    <input type="text" name="MortgageCompany/Financiera" class="MortgageCompany/Financiera">
                </td>
                <td colspan="2">
                    <span class="field-label">Monthly Payment / Pago Mensual <span style="color: red;">*</span></span>
                    <input type="text" name="MonthlyPayment/PagoMensual" class="MonthlyPayment/PagoMensual" required>
                </td>
                <td colspan="2">
                    <span class="field-label">Remaining Time / Tiempo Restante <span style="color: red;">*</span></span>
                    <input type="text" name="RemainingTime/TiempoRestante" class="RemainingTime/TiempoRestante" required>
                </td>
            </tr>
        </table>

        <table>
            <tr>
                <td colspan="6" class="section-header"> Income Information / Información de Ingresos</td>
                <td colspan="6" class="section-header"> Income Information / Información de Ingresos</td>
            </tr>
            <tr>
                <td colspan="2">
                    <span class="field-label">Employer / Empleador <span style="color: red;">*</span></span>
                    <input type="text" name="Employer/Empleador1" class="Employer/Empleador1" required>
                </td>
                <td colspan="2">
                    <span class="field-label"> Years / Años <span style="color: red;">*</span></span>
                    <input type="text" name="Years/Años1" class="Years/Años1" required>
                </td>
                <td colspan="2">
                    <span class="field-label" >Income / Ingreso <span style="color: red;">*</span></span>
                    <input type="text" name="Income/Ingreso1" class="Income/Ingreso1" required>
                </td>
                <td colspan="2">
                    <span class="field-label">Employer / Empleador</span>
                    <input type="text" name="Employer/Empleador2" class="Employer/Empleador2">
                </td>
                <td colspan="2">
                    <span class="field-label"> Years / Años</span>
                    <input type="text" name="Years/Años2" class="Years/Años2">
                </td>
                <td colspan="2">
                    <span class="field-label">Income / Ingreso</span>
                    <input type="text" name="Income/Ingreso2" class="Income/Ingreso2">
                </td>
            </tr>
            <tr>
                <td colspan="3">
                    <span class="field-label">Ocupation / Cargo <span style="color: red;">*</span></span>
                    <input type="text" name="Ocupation/Cargo1" class="Ocupation/Cargo1" required>
                </td>
                <td colspan="3">
                    <span class="field-label">Business Phone / Teléfono de Trabajo</span>
                    <input type="tel" name="BusinessPhone/TeléfonodeTrabajo1" class="BusinessPhone/TeléfonodeTrabajo1">
                </td>
                <td colspan="3">
                    <span class="field-label">Ocupation / Cargo</span>
                    <input type="text" name="Ocupation/Cargo2" class="Ocupation/Cargo2">
                </td>
                <td colspan="3">
                    <span class="field-label">Business Phone / Teléfono de Trabajo</span>
                    <input type="tel" name="BusinessPhone/TeléfonodeTrabajo1" class="BusinessPhone/TeléfonodeTrabajo1">
                </td>
            </tr>
            <tr>
                <td colspan="6">
                    <span class="field-label"> Address / Direcciónn</span>
                    <input type="text" name="Address/Direcciónn3" class="Address/Direcciónn3">
                </td>
                <td colspan="6">
                    <span class="field-label"> Address / Dirección</span>
                    <input type="text" name="Address/Direcciónn4" class="Address/Direcciónn4">
                </td>
            </tr>
            <tr>
                <td colspan="3">
                    <span class="field-label">City / Ciudad</span>
                    <input type="text" name="City/Ciudad3" class="City/Ciudad3">
                </td>
                <td>
                    <span class="field-label">State / Estado</span>
                    <input type="text" name="State/Estado3" class="State/Estado3">
                </td>
                <td colspan="2">
                    <span class="field-label">Zip Code / Código Postal</span>
                    <input type="text" name="ZipCode/CódigoPostal3" class="ZipCode/CódigoPostal3">
                </td>
                <td colspan="3">
                    <span class="field-label">City / Ciudad</span>
                    <input type="text" name="City/Ciudad4" class="City/Ciudad4">
                </td>
                <td>
                    <span class="field-label">State / Estado</span>
                    <input type="text" name="State/Estado4" class="State/Estado4">
                </td>
                <td colspan="2">
                    <span class="field-label">Zip Code / Código Postal</span>
                    <input type="text" name="ZipCode/CódigoPostal4" class="ZipCode/CódigoPostal4">
                </td>
            </tr>
            <tr>
                <td colspan="6">
                    <span class="field-label">Other source of income / Otros Ingresos</span>
                    <input type="text" name="Othersourceofincome/OtrosIngresos1" class="Othersourceofincome/OtrosIngresos1">
                </td>
                <td colspan="6">
                    <span class="field-label">Other source of income / Otros Ingresos</span>
                    <input type="text" name="Othersourceofincome/OtrosIngresos2" class="Othersourceofincome/OtrosIngresos2">
                </td>
            </tr>
            <tr>
                <td colspan="12" style="font-size: 10px; padding: 7px;">
                    <p>
                        Alimony or child support are optional information and does not need to be disclosed if you do not wish for that income to be considered in the credit application.
                        Pensión alimenticia o manutanción de menores son información opcional y no necesita ser revelada si usted no desea que se cuente ese ingreso en la solicitud de crédito.
                    </p>
                        
                </td>
            </tr>
        </table>

        <table>
            <tr >
                <td colspan="12" style="font-size: 8px; padding: 5px; background:linear-gradient(to right, rgba(0, 0, 255, 0.833),lightblue); color: white;">
                    By signing the document, the applicant gives consent to the company to collect and verify personal and financial information, including credit reports, for the purpose of assessing eligibility for a service or loan. The applicant allows the company to share this information with 
                    authorized third parties, such as credit agencies, to complete the verification process. The applicant confirms that the information provided is accurate and understands that false information could lead to rejection of the application.
                    Al firmar este documento, el solicitante da su consentimiento para que la empresa recoja y verifique información personal y financiera, incluidos los informes de crédito, con el propósito de evaluar la elegibilidad para un servicio o préstamo. El solicitante autoriza a la empresa 
                    a compartir esta información con terceros autorizados, como agencias de crédito, para completar el proceso de verificación. El solicitante confirma que la información proporcionada es precisa y entiende que la información falsa podría resultar en el rechazo de la solicitud.
                    
                </td>
            </tr>
            <tr>
                <td colspan="4" class="signature-cell" >
                  <canvas class="signature1" width="340" height="100" 
                    style="border-radius:8px; background:#fff; width:100%; height:100px;"></canvas>
                </td>
              
                <td colspan="4" class="signature-cell">
                  <canvas class="signature2" width="340" height="100" 
                    style=" border-radius:8px; background:#fff; width:100%; height:100px;"></canvas>
                </td>
              
                <td colspan="4" class="signature-cell">
                  <canvas class="signature3" width="340" height="100" 
                    style="border-radius:8px; background:#fff; width:100%; height:100px;"></canvas>
                </td>
              </tr>
              
            <tr>
                <td colspan="4" style="padding-left: 4px;">
                    <span style="font-size: smaller;">Applicant Signature / Firma del Aplicante <span style="color: red;">*</span></span>
                    <div style="display: flex; padding-top: 10px; ">
                        <span class="field-label" style="width: 120px; font-size: small;">Date / Fecha <span style="color: red;">*</span></span>
                        <input type="date" name="Date/Fecha2" class="Date/Fecha2" required>
                    </div>
                    
                </td>
                <td colspan="4">
                    <span style="font-size: smaller;">Co-Applicant Signature / Firma del Co-Aplicante</span>
                    <div style="display: flex; padding-top: 10px;">
                    <span class="field-label" style="width: 120px; font-size: small;">Date / Fecha</span>
                    <input type="date" name="Date/Fecha3" class="Date/Fecha3" style="width: 100%;">
                    </div>
                </td>
                <td colspan="4" style=" width: 30%;">
                    <span style="font-size: 12px;" >Representative Signature / Firma del Representante <span style="color: red;">*</span></span>
                    <div style="display: flex;padding-top: 10px; ">
                    <span class="field-label" style="width: 200px; font-size: small;">Name / Nombre <span style="color: red;">*</span></span>
                    <input type="text" name="Name/Nombre"  class="Name/Nombre" required style="width: 100%;">
                    </div>
                </td>
            </tr>
        </table>
        <div id="footer">
            <div>
                <label for="files">Upload Files (max 3):</label>
                <input type="file" id="files" name="files" multiple>
                <p id="fileError" style="color: red; font-size: 14px;"></p>
            </div>
            <div style="text-align:center; margin-top:15px;">
                <button id="savePdf" style="background:#0099cc; color:white; padding:8px 16px; border:none; border-radius:5px; cursor:pointer; ">Send</button>
              </div>
        </div>
        </table>

    </div>

    <div class="form-container1">
        <div class="header-section">
            <div style="display: flex; width: 100%; justify-content: space-between; position: relative;">
                <img src="images/MainLogo.PNG" alt="" style="width: 100%; height: 50%;">
                <img src="images/logo.png" alt="" style="width: 30%; height: 20%; position: absolute; right: 0;">
            </div>
            <div class="form-title">Credit Application / Aplicación de Crédito</div>
            
            <div style="display: flex; justify-content: center; align-items: center; flex-direction: column;">
                <div class="field-group">
                    <label class="field-label">Date / Fecha <span style="color: red;">*</span></label>
                    <input type="date" name="Date/Fecha1" class="Date/Fecha1" required >
                </div>
                <div class="field-group">
                    <label class="field-label">Amount to Finance / Monto a Financiar <span style="color: red;">*</span></label>
                    <input type="text" style="width: 100%; height: 100%;" name="AmounttoFinance/MontoaFinanciar1" class="AmounttoFinance/MontoaFinanciar1" placeholder="Enter Amount to Finance / Monto a Financiar" required>
                </div>

            </div>
        </div>

        <div class="section-header">Applicant / Aplicante</div>
        
        <div class="field-group">
            <label class="field-label">First Name / Nombre <span style="color: red;">*</span></label>
            <input type="text" name="FirstName/Nombre1" class="FirstName/Nombre1" placeholder="Enter First Name / Nombre" required>
        </div>
        
        <div class="field-group">
            <label class="field-label">Last Name / Apellido <span style="color: red;">*</span></label>
            <input type="text" name="LastName/Apellido1" class="LastName/Apellido1" placeholder="Enter Last Name / Apellido" required>
        </div>
        
        <div class="field-group">
            <label class="field-label">Social Security # / Nro. Seguro Social <span style="color: red;">*</span></label>
            <input type="text" name="SocialSecurity#/Nro.SeguroSocial1" class="SocialSecurity#/Nro.SeguroSocial1" placeholder="Enter Social Security # / Nro. Seguro Social " required>
        </div>
        
        <div class="field-group">
            <label class="field-label">Date of Birth / Fecha de Nacimiento <span style="color: red;">*</span></label>
           <input type="date" name="DateofBirth/FechadeNacimiento1" class="DateofBirth/FechadeNacimiento1" required>
        </div>
        
        <div class="field-group">
            <label class="field-label">Driver's License # / ID # <span style="color: red;">*</span></label>
            <input type="text" name="Driver’sLicense#/ID#1" class="Driver’sLicense#/ID#1" placeholder="Enter Driver's License # / ID # " required>
        </div>
        
        <div class="field-group">
            <label class="field-label">Expiration Date / Fecha de Expiración <span style="color: red;">*</span></label>
            <input type="date" name="ExpirationDate/FechadeExpiración1" class="ExpirationDate/FechadeExpiración1" required>
        </div>
        
        <div class="field-group">
            <label class="field-label">Phone / Teléfono <span style="color: red;">*</span></label>
            <input type="tel" name="Phone/Teléfono1" class="Phone/Teléfono1" placeholder=" Enter Phone / Teléfono" required>
        </div>
        
        <div class="field-group">
            <label class="field-label">Email <span style="color: red;">*</span></label>
            <input type="email" name="Email1" class="Email1" placeholder="Enter Email" required>
        </div>
        
        <div class="field-group">
            <label class="field-label">Address / Dirección <span style="color: red;">*</span></label>
            <input type="text" name="Address/Dirección1" class="Address/Dirección1" placeholder="Enter Address / Dirección" required>
        </div>
        
        <div class="field-group">
            <label class="field-label">City / Ciudad <span style="color: red;">*</span></label>
            <input type="text" name="City/Ciudad1" class="City/Ciudad1" placeholder="Enter City/Ciudad" required>
        </div>
        
        <div class="field-group">
            <label class="field-label">State / Estado <span style="color: red;">*</span></label>
            <input type="text" class="State/Estado1" name="State/Estado1" placeholder="Enter State / Estado" required>
        </div>
        
        <div class="field-group">
            <label class="field-label">Zip Code / Código Postal <span style="color: red;">*</span></label>
            <input type="text" name="ZipCode/CódigoPostal1" class="ZipCode/CódigoPostal1" placeholder="Enter Zip Code / Código Postal" required>
        </div>

        <!-- Co-Applicant Section -->
        <div class="section-header">Co-Applicant / Co-Aplicante</div>
        
        <div class="field-group">
            <label class="field-label">First Name / Nombre</label>
            <input type="text" name="FirstName/Nombre2" class="FirstName/Nombre2" placeholder="Enter First Name / Nombre">
        </div>
        
        <div class="field-group">
            <label class="field-label">Last Name / Apellido</label>
            <input type="text" name="LastName/Apellido2" class="LastName/Apellido2" placeholder="Enter Last Name / Apellido" >
        </div>
        
        <div class="field-group">
            <label class="field-label">Social Security # / Nro. Seguro Social</label>
             <input type="text" name="SocialSecurity#/Nro.SeguroSocial2" class="SocialSecurity#/Nro.SeguroSocial2" placeholder="Enter Social Security # / Nro. Seguro Social " >
        </div>
        
        <div class="field-group">
            <label class="field-label">Date of Birth / Fecha de Nacimiento</label>
            <input type="date" name="DateofBirth/FechadeNacimiento2" class="DateofBirth/FechadeNacimiento2" >
        </div>
        
        <div class="field-group">
            <label class="field-label">Driver's License # / ID #</label>
            <input type="text" name="Driver’sLicense#/ID#2" class="Driver’sLicense#/ID#2" placeholder="Enter Driver's License # / ID # ">
        </div>
        
        <div class="field-group">
            <label class="field-label">Expiration Date / Fecha de Expiración</label>
            <input type="date" name="ExpirationDate/FechadeExpiración2" class="ExpirationDate/FechadeExpiración2" >
        </div>
        
        <div class="field-group">
            <label class="field-label">Phone / Teléfono</label>
            <input type="tel" name="Phone/Teléfono2" class="Phone/Teléfono2" placeholder=" Enter Phone / Teléfono">
        </div>
        
        <div class="field-group">
            <label class="field-label">Email</label>
            <input type="email" name="Email2" class="Email2" placeholder="Enter Email" >
        </div>
        
        <div class="field-group">
            <label class="field-label">Address / Dirección</label>
            <input type="text" name="Address/Dirección2" class="Address/Dirección2" placeholder="Enter Address / Dirección" >
        </div>
        
        <div class="field-group">
            <label class="field-label">City / Ciudad</label>
            <input type="text" name="City/Ciudad2" class="City/Ciudad2" placeholder="Enter City/Ciudad" >
        </div>
        
        <div class="field-group">
            <label class="field-label">State / Estado</label>
            <input type="text" class="State/Estado2" name="State/Estado2" placeholder="Enter State / Estado" >
        </div>
        
        <div class="field-group">
            <label class="field-label">Zip Code / Código Postal</label>
            <input type="text" name="ZipCode/CódigoPostal2" class="ZipCode/CódigoPostal2" placeholder="Enter Zip Code / Código Postal">
        </div>
        
        <div class="section-header">Mortgage Information / Información Hipotecaria</div>
        
        <div class="field-group">
            <label class="field-label">Status / Estado <span style="color: red;">*</span>
            </label>
            <div class="checkbox-section">
                <label>
                    <input type="checkbox" name="Paid/Pagada" class="">
                    <span>Paid / Pagada</span>
                </label>
                <label>
                    <input type="checkbox">
                    <span>Mortgaged / Financiada</span>
                </label>
                <label>
                    <input type="checkbox">
                    <span>Rent / Alquiler</span>
                </label>
            </div>
        </div>
        
        <div class="field-group">
            <label class="field-label">Mortgage Company / Financiera</label>
            <input type="text" name="MortgageCompany/Financiera" class="MortgageCompany/Financiera" placeholder="Enter Mortgage Company / Financiera">
        </div>
        
        <div class="field-group">
            <label class="field-label">Monthly Payment / Pago Mensual <span style="color: red;">*</span></label>
            <input type="text" name="MonthlyPayment/PagoMensual" class="MonthlyPayment/PagoMensual" placeholder="Enter Monthly Payment / Pago Mensual" required>
        </div>
        
        <div class="field-group">
            <label class="field-label">Remaining Time / Tiempo Restante <span style="color: red;">*</span></label>
            <input type="text" name="RemainingTime/TiempoRestante" class="RemainingTime/TiempoRestante" placeholder="Enter Remaining Time / Tiempo Restante" required>
        </div>
        
        <!-- Income Information - Applicant -->
        <div class="section-header">Income Information / Información de Ingresos (Applicant)</div>
        
        <div class="field-group">
            <label class="field-label">Employer / Empleador <span style="color: red;">*</span></label>
            <input type="text" name="Employer/Empleador1" class="Employer/Empleador1" placeholder="Enter Employer / Empleador" required>
        </div>
        
        <div class="field-group">
            <label class="field-label">Years / Años <span style="color: red;">*</span></label>
            <input type="text" name="Years/Años1" class="Years/Años1" placeholder="Enter Years / Años" required>
        </div>
        
        <div class="field-group">
            <label class="field-label">Income / Ingreso <span style="color: red;">*</span></label>
            <input type="text" name="Income/Ingreso1" class="Income/Ingreso1" placeholder="Enter Income / Ingreso" required>
        </div>
        
        <div class="field-group">
            <label class="field-label">Ocupation / Cargo <span style="color: red;">*</span></label>
            <input type="text" name="Ocupation/Cargo1" class="Ocupation/Cargo1" placeholder="Enter Ocupation / Cargo" required>
        </div>
        
        <div class="field-group">
            <label class="field-label">Business Phone / Teléfono de Trabajo</label>
            <input type="tel" name="BusinessPhone/TeléfonodeTrabajo1" class="BusinessPhone/TeléfonodeTrabajo1" placeholder="Enter Business Phone / Teléfono de Trabajo" required>
        </div>
        
        <div class="field-group">
            <label class="field-label">Address / Dirección</label>
            <input type="text" name="Address/Dirección3" class="Address/Dirección3" placeholder="Enter Address / Dirección">
        </div>
        
        <div class="field-group">
            <label class="field-label">City / Ciudad</label>
            <input type="text" name="City/Ciudad3" class="City/Ciudad3" placeholder="Enter City / Ciudad">
        </div>
        
        <div class="field-group">
            <label class="field-label">State / Estado</label>
            <input type="text" name="State/Estado3" class="State/Estado3" placeholder="Enter State / Estado">
        </div>
        
        <div class="field-group">
            <label class="field-label">Zip Code / Código Postal</label>
            <input type="text" name="ZipCode/CódigoPostal3" class="ZipCode/CódigoPostal3" placeholder="Enter Zip Code / Código Postal">
        </div>
        
        <div class="field-group">
            <label class="field-label">Other Source of Income / Otros Ingresos</label>
            <input type="text" name="OtherSourceofIncome/OtrosIngresos1" class="OtherSourceofIncome/OtrosIngresos" placeholder="Enter Other Source of Income / Otros Ingresos">
        </div>
        
        <div class="section-header">Income Information / Información de Ingresos (Co-Applicant)</div>
        
        <div class="field-group">
            <label class="field-label">Employer / Empleador</label>
            <input type="text" name="Employer/Empleador2" class="Employer/Empleador2" placeholder="Enter Employer / Empleador">
        </div>
        
        <div class="field-group">
            <label class="field-label">Years / Años</label>
            <input type="text" name="Years/Años2" class="Years/Años2" placeholder="Enter Years / Años">
        </div>
        
        <div class="field-group">
            <label class="field-label">Income / Ingreso</label>
            <input type="text" name="Income/Ingreso2" class="Income/Ingreso2" placeholder="Enter Income / Ingreso">
        </div>
        
        <div class="field-group">
            <label class="field-label">Ocupation / Cargo</label>
            <input type="text" name="Ocupation/Cargo2" class="Ocupation/Cargo2" placeholder="Enter Ocupation / Cargo">
        </div>
        
        <div class="field-group">
            <label class="field-label">Business Phone / Teléfono de Trabajo</label>
            <input type="tel" name="BusinessPhone/TeléfonodeTrabajo2" class="BusinessPhone/TeléfonodeTrabajo2" placeholder="Enter Business Phone / Teléfono de Trabajo">
        </div>
        
        <div class="field-group">
            <label class="field-label">Address / Dirección</label>
            <input type="text" name="Address/Dirección4" class="Address/Dirección4" placeholder="Enter Address / Dirección">
        </div>
        
        <div class="field-group">
            <label class="field-label">City / Ciudad</label>
            <input type="text" name="City/Ciudad4" class="City/Ciudad4" placeholder="Enter City / Ciudad">
        </div>
        
        <div class="field-group">
            <label class="field-label">State / Estado</label>
            <input type="text" name="State/Estado4" class="State/Estado4" placeholder="Enter State / Estado">
        </div>
        
        <div class="field-group">
            <label class="field-label">Zip Code / Código Postal</label>
            <input type="text" name="ZipCode/CódigoPostal4" class="ZipCode/CódigoPostal4" placeholder="Enter Zip Code / Código Postal ">
        </div>
        
        <div class="field-group">
            <label class="field-label">Other Source of Income / Otros Ingresos</label>
            <input type="text" name="OtherSourceofIncome/OtrosIngresos2" class="OtherSourceofIncome/OtrosIngresos2" placeholder="Enter Other Source of Income / Otros Ingresos">
        </div>
        
        <!-- Disclaimer -->
        <div class="disclaimer">
            Alimony or child support are optional information and does not need to be disclosed if you do not wish for that income to be considered in the credit application.<br><br>
            Pensión alimenticia o manutención de menores son información opcional y no necesita ser revelada si usted no desea que se cuente ese ingreso en la solicitud de crédito.
        </div>
        
        <!-- Consent Text -->
        <div class="consent-text">
            By signing the document, the applicant gives consent to the company to collect and verify personal and financial information, including credit reports, for the purpose of assessing eligibility for a service or loan. The applicant allows the company to share this information with authorized third parties, such as credit agencies, to complete the verification process. The applicant confirms that the information provided is accurate and understands that false information could lead to rejection of the application.<br><br>
            Al firmar este documento, el solicitante da su consentimiento para que la empresa recoja y verifique información personal y financiera, incluidos los informes de crédito, con el propósito de evaluar la elegibilidad para un servicio o préstamo. El solicitante autoriza a la empresa a compartir esta información con terceros autorizados, como agencias de crédito, para completar el proceso de verificación. El solicitante confirma que la información proporcionada es precisa y entiende que la información falsa podría resultar en el rechazo de la solicitud.
        </div>
        
        <div class="signature-box">
            <h4>Applicant Signature / Firma del Aplicante <span style="color: red;">*</span></h4>
            <canvas class="signature1"></canvas>
            <div class="signature-date">
                <label class="field-label">Date / Fecha <span style="color: red;">*</span></label>
                <input type="date" name="Date/Fecha2" class="Date/Fecha2" required>
            </div>
        </div>
        
        <div class="signature-box">
            <h4>Co-Applicant Signature / Firma del Co-Aplicante</h4>
            <canvas class="signature2"></canvas>
            <div class="signature-date">
                <label class="field-label">Date / Fecha</label>
                <input type="date" name="Date/Fecha3" class="Date/Fecha3">
            </div>
        </div>
        
        <div class="signature-box">
            <h4>Representative Signature / Firma del Representante <span style="color: red;">*</span></h4>
            <canvas class="signature3"></canvas>
            <div class="signature-date">
                <label class="field-label">Name / Nombre <span style="color: red;">*</span></label>
                <input type="text" name="Name/Nombre" id="Name/Nombre" placeholder="Name / Nombre" required>
            </div>
        </div>
        
        <div class="footer">
            <div class="field-group">
                <label for="files">Upload Files (max 3):</label>
                <input type="file" id="files" name="files" multiple>
                <p id="fileError"></p>
            </div>
            
            <button id="savePdf1">Send</button>
        </div>
        </div>
    </div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
const { jsPDF } = window.jspdf;

let canvases = {
  pc: [],
  mobile: []
};

function enableSignature(canvas, isMobile = false) {
  if (!canvas) return;

  const ctx = canvas.getContext("2d");
  let drawing = false;

  function getPos(e) {
    const rect = canvas.getBoundingClientRect();
    return {
      x: (e.touches ? e.touches[0].clientX : e.clientX) - rect.left,
      y: (e.touches ? e.touches[0].clientY : e.clientY) - rect.top
    };
  }

  function startDrawing(e) {
    e.preventDefault();
    drawing = true;
    const pos = getPos(e);
    ctx.beginPath();
    ctx.moveTo(pos.x, pos.y);
  }

  function draw(e) {
    if (!drawing) return;
    e.preventDefault();
    
    const pos = getPos(e);
    ctx.lineWidth = 2;
    ctx.lineCap = "round";
    ctx.lineJoin = "round";
    ctx.strokeStyle = "#000";
    ctx.lineTo(pos.x, pos.y);
    ctx.stroke();
    
    if (!canvas._syncTimeout) {
      canvas._syncTimeout = setTimeout(() => {
        syncCanvases(canvas);
        canvas._syncTimeout = null;
      }, 150);
    }
  }

  function stopDrawing(e) {
    e.preventDefault();
    drawing = false;
  }

  canvas.addEventListener("mousedown", startDrawing);
  canvas.addEventListener("mousemove", draw);
  canvas.addEventListener("mouseup", stopDrawing);
  canvas.addEventListener("mouseout", stopDrawing);

  canvas.addEventListener("touchstart", startDrawing, { passive: false });
  canvas.addEventListener("touchmove", draw, { passive: false });
  canvas.addEventListener("touchend", stopDrawing, { passive: false });

  console.log(`✅ Canvas enabled (${isMobile ? 'Mobile' : 'PC'})`);
}

function syncCanvases(sourceCanvas) {
  if (!sourceCanvas) return;

  const isMobile = sourceCanvas.closest(".form-container1") !== null;
  const sourceForm = isMobile ? document.querySelector(".form-container1") : document.querySelector(".form-container");
  const targetForm = isMobile ? document.querySelector(".form-container") : document.querySelector(".form-container1");

  if (!sourceForm || !targetForm) return;

  const sourceCanvases = Array.from(sourceForm.querySelectorAll("canvas"));
  const targetCanvases = Array.from(targetForm.querySelectorAll("canvas"));

  sourceCanvases.forEach((source, index) => {
    const target = targetCanvases[index];
    if (!target) return;

    try {
      const sourceImage = source.toDataURL();
      const img = new Image();
      img.onload = () => {
        const targetCtx = target.getContext("2d");
        targetCtx.clearRect(0, 0, target.width, target.height);
        targetCtx.drawImage(img, 0, 0, target.width, target.height);
      };
      img.src = sourceImage;
    } catch (e) {
      console.log("Sync error for canvas", index);
    }
  });
}

function initializeCanvases() {
  const pcForm = document.querySelector(".form-container");
  if (pcForm) {
    canvases.pc = Array.from(pcForm.querySelectorAll("canvas"));
    console.log(`PC canvases found: ${canvases.pc.length}`);
    canvases.pc.forEach(canvas => enableSignature(canvas, false));
  }

  const mobileForm = document.querySelector(".form-container1");
  if (mobileForm) {
    canvases.mobile = Array.from(mobileForm.querySelectorAll("canvas"));
    console.log(`Mobile canvases found: ${canvases.mobile.length}`);
    canvases.mobile.forEach(canvas => enableSignature(canvas, true));
  }

  console.log("✅ All canvases initialized");
}

function setupFormSync() {
  const mobileForm = document.querySelector(".form-container1");
  const pcForm = document.querySelector(".form-container");

  if (!mobileForm || !pcForm) return;

  const getFieldsMap = (form) => {
    const fieldsMap = {};
    const inputs = form.querySelectorAll("input[name], textarea[name], select[name]");
    inputs.forEach(inp => {
      const name = inp.name;
      if (name) {
        if (!fieldsMap[name]) fieldsMap[name] = [];
        fieldsMap[name].push(inp);
      }
    });
    return fieldsMap;
  };

  const mobileFields = getFieldsMap(mobileForm);
  const pcFields = getFieldsMap(pcForm);

  Object.keys(mobileFields).forEach(fieldName => {
    mobileFields[fieldName].forEach(mobileInput => {
      if (mobileInput.type === "checkbox") {
        mobileInput.addEventListener("change", () => {
          pcFields[fieldName]?.forEach(pcInput => {
            if (pcInput.type === "checkbox") pcInput.checked = mobileInput.checked;
          });
        });
      } else {
        mobileInput.addEventListener("input", () => {
          pcFields[fieldName]?.forEach(pcInput => {
            pcInput.value = mobileInput.value;
          });
        });
      }
    });
  });

  Object.keys(pcFields).forEach(fieldName => {
    pcFields[fieldName].forEach(pcInput => {
      if (pcInput.type === "checkbox") {
        pcInput.addEventListener("change", () => {
          mobileFields[fieldName]?.forEach(mobileInput => {
            if (mobileInput.type === "checkbox") mobileInput.checked = pcInput.checked;
          });
        });
      } else {
        pcInput.addEventListener("input", () => {
          mobileFields[fieldName]?.forEach(mobileInput => {
            mobileInput.value = pcInput.value;
          });
        });
      }
    });
  });
}

function finalSyncBeforePdf() {
  const mobileForm = document.querySelector(".form-container1");
  const pcForm = document.querySelector(".form-container");

  if (!mobileForm || !pcForm) return;

  const mobileCanvases = Array.from(mobileForm.querySelectorAll("canvas"));
  const pcCanvases = Array.from(pcForm.querySelectorAll("canvas"));

  mobileCanvases.forEach((mobileCanvas, index) => {
    const pcCanvas = pcCanvases[index];
    if (!pcCanvas) return;

    try {
      const mobileImage = mobileCanvas.toDataURL();
      const img = new Image();
      img.onload = () => {
        const pcCtx = pcCanvas.getContext("2d");
        pcCtx.clearRect(0, 0, pcCanvas.width, pcCanvas.height);
        pcCtx.drawImage(img, 0, 0, pcCanvas.width, pcCanvas.height);
      };
      img.src = mobileImage;
    } catch (e) {
      console.log("Final sync error");
    }
  });

  const mobileInputs = mobileForm.querySelectorAll("input[name], textarea[name]");
  mobileInputs.forEach(mobileInput => {
    const pcInputs = pcForm.querySelectorAll(`[name='${mobileInput.name}']`);
    pcInputs.forEach(pcInput => {
      if (mobileInput.type === "checkbox") {
        pcInput.checked = mobileInput.checked;
      } else if (mobileInput.type !== "radio") {
        pcInput.value = mobileInput.value;
      }
    });
  });
}

function isCanvasEmpty(canvas) {
  const ctx = canvas.getContext("2d");
  const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
  const data = imageData.data;
  
  for (let i = 3; i < data.length; i += 4) {
    if (data[i] !== 255) {
      return false;
    }
  }
  return true;
}

function isValidEmail(email) {
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  return emailRegex.test(email);
}

function validateRequiredFields() {
  const pcForm = document.querySelector(".form-container");
  if (!pcForm) {
    Swal.fire({
      icon: 'error',
      title: 'Error!',
      confirmButtonColor: '#3085d6'
    });
    return false;
  }

  const requiredFields = pcForm.querySelectorAll("input[required], textarea[required], select[required]");
  let emptyFields = [];

  requiredFields.forEach(field => {
    if (field.type === "checkbox") {
      if (!field.checked) emptyFields.push(field.name);
    } else if (!field.value || field.value.trim() === "") {
      emptyFields.push(field.name);
    }
  });

  // Email validation
  const emailField = pcForm.querySelector("input[name='email']");
  if (emailField && emailField.value && !isValidEmail(emailField.value)) {
    emptyFields.push("Email!");
  }

  if (canvases.pc.length >= 1) {
    const sig1Canvas = canvases.pc[0];
    if (isCanvasEmpty(sig1Canvas)) {
      emptyFields.push("Applicant Signature ");
    }
  }

  if (canvases.pc.length >= 3) {
    const sig3Canvas = canvases.pc[2];
    if (isCanvasEmpty(sig3Canvas)) {
      emptyFields.push("Representative Signature ");
    }
  }

  if (emptyFields.length > 0) {
    Swal.fire({
      icon: 'warning',
      title: 'Empty Fields!',
      html: `<div style="text-align: left;">${[...new Set(emptyFields)].join("<br>")}</div>`,
      confirmButtonColor: '#3085d6'
    });
    return false;
  }
  return true;
}

async function generatePDF() {
  const pcForm = document.querySelector(".form-container");

  if (!pcForm) {
    Swal.fire({
      icon: 'error',
      title: 'Error!',
      text: 'Form not found!',
      confirmButtonColor: '#3085d6'
    });
    return null;
  }

  try {
    const originalDisplay = pcForm.style.display;
    const originalVisibility = pcForm.style.visibility;
    
    pcForm.style.display = 'block';
    pcForm.style.visibility = 'visible';
    pcForm.style.position = 'absolute';
    pcForm.style.left = '-9999px';
    pcForm.style.top = '0';

    await new Promise(resolve => setTimeout(resolve, 100));

    const canvas = await html2canvas(pcForm, {
      scale: 2,
      useCORS: true,
      allowTaint: true,
      logging: false,
      backgroundColor: "#ffffff",
      width: pcForm.scrollWidth,
      height: pcForm.scrollHeight,
      windowWidth: 1200,
      windowHeight: pcForm.scrollHeight
    });

    pcForm.style.display = originalDisplay;
    pcForm.style.visibility = originalVisibility;
    pcForm.style.position = '';
    pcForm.style.left = '';
    pcForm.style.top = '';

    if (!canvas || canvas.width === 0 || canvas.height === 0) {
      throw new Error("Invalid canvas dimensions");
    }

    const imgData = canvas.toDataURL("image/jpeg", 0.85);
    const pdf = new jsPDF("p", "mm", "a4");
    const pageWidth = pdf.internal.pageSize.getWidth();
    const pageHeight = pdf.internal.pageSize.getHeight();

    const imgWidth = pageWidth;
    const imgHeight = (canvas.height * imgWidth) / canvas.width;

    if (!imgHeight || imgHeight <= 0 || !isFinite(imgHeight)) {
      throw new Error("Invalid image dimensions calculated");
    }

    let position = 0;
    let heightLeft = imgHeight;

    pdf.addImage(imgData, "JPEG", 0, position, imgWidth, imgHeight, "", "FAST");
    heightLeft -= pageHeight;

    while (heightLeft > 0) {
      position = heightLeft - imgHeight;
      pdf.addPage();
      pdf.addImage(imgData, "JPEG", 0, position, imgWidth, imgHeight, "", "FAST");
      heightLeft -= pageHeight;
    }

    return pdf;
  } catch (err) {
    console.error("PDF generation error:", err);
    Swal.fire({
      icon: 'error',
      title: 'PDF Error!',
      text: 'Error: ' + err.message,
      confirmButtonColor: '#3085d6'
    });
    return null;
  }
}

async function handleSubmit() {
  if (!validateRequiredFields()) {
    return;
  }

  const pcForm = document.querySelector(".form-container");
  const fileInput = document.getElementById("files");

  if (window.innerWidth <= 480) {
    finalSyncBeforePdf();
    await new Promise(resolve => setTimeout(resolve, 1000));
  }

  const pdf = await generatePDF();
  if (!pdf) return;

  const pdfBlob = pdf.output("blob");

  const formData = new FormData();
  formData.append("formPdf", pdfBlob, "form.pdf");

  // Email شامل کریں
  const emailField = pcForm.querySelector("input[name='email']");
  if (emailField && emailField.value) {
    formData.append("email", emailField.value);
  }

  if (fileInput?.files.length > 0) {
    for (let f of fileInput.files) {
      formData.append("files", f);
    }
  }

  try {
    const response = await fetch("https://credtt-application-backend.vercel.app/submit-form", {
      method: "POST",
      body: formData,
    });
    console.log(response);
    const result = await response.json();
    if (result.success) {
      Swal.fire({
        icon: 'success',
        title: 'Success!',
        text: 'Form submitted successfully!',
        confirmButtonColor: '#3085d6'
      });
    } else {
      Swal.fire({
        icon: 'error',
        title: 'Error!',
        text: result.message || 'Something went wrong',
        confirmButtonColor: '#3085d6'
      });
    }
  } catch (err) {
    console.error("Submit error:", err);
    Swal.fire({
      icon: 'error',
      title: 'Error!',
      text: err.message,
      confirmButtonColor: '#3085d6'
    });
  }
}

window.addEventListener("DOMContentLoaded", () => {
  console.log("Initializing...");
  
  initializeCanvases();
  setupFormSync();
  
  const pcBtn = document.getElementById("savePdf");
  const mobileBtn = document.getElementById("savePdf1");

  if (pcBtn) pcBtn.addEventListener("click", handleSubmit);
  if (mobileBtn) mobileBtn.addEventListener("click", handleSubmit);

});

const fileInput = document.getElementById("files");
if (fileInput) {
  fileInput.addEventListener("change", () => {
    const fileError = document.getElementById("fileError");
    if (fileInput.files.length > 3) {
      Swal.fire({
        icon: 'warning',
        title: 'Too Many Files!',
        text: 'Maximum 3 files allowed!',
        timer: 2000,
        confirmButtonColor: '#3085d6'
      });
      fileInput.value = "";
    }
  });
}
</script>

</body>
</html>